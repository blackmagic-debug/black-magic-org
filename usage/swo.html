<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" type="image/svg+xml" href="../_static/favicon/icon.svg">
    <link rel="icon" sizes="16x16" type="image/png" href="../_static/favicon/favicon-16x16.png">
    <link rel="icon" sizes="32x32" type="image/png" href="../_static/favicon/favicon-32x32.png">
    <link rel="apple-touch-icon" sizes="57x57" type="image/png" href="../_static/favicon/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" type="image/png" href="../_static/favicon/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" type="image/png" href="../_static/favicon/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" type="image/png" href="../_static/favicon/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="96x96" type="image/png" href="../_static/favicon/apple-touch-icon-96x96.png">
    <link rel="apple-touch-icon" sizes="114x114" type="image/png" href="../_static/favicon/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" type="image/png" href="../_static/favicon/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" type="image/png" href="../_static/favicon/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" type="image/png" href="../_static/favicon/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" type="image/png" href="../_static/favicon/apple-touch-icon-180x180.png">
    <link rel="android-icon" sizes="192x192" type="image/png" href="../_static/favicon/android-icon-192x192.png"><meta property="og:title" content="Serial Wire Output" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://black-magic.org/usage/swo.html" />
<meta property="og:site_name" content="Black Magic Debug" />
<meta property="og:description" content="Serial Wire Output (SWO) allows the target to produce tracing and logging information from your firmware without using precious peripherals such as USB or UARTs. Instead, the data is emitted via a ..." />
<meta property="og:image" content="https://black-magic.org/_static/blackmagic-logo.png" />
<meta property="og:image:alt" content="Black Magic Debug" />
<meta name="description" content="Serial Wire Output (SWO) allows the target to produce tracing and logging information from your firmware without using precious peripherals such as USB or UARTs. Instead, the data is emitted via a ..." />
<link rel="index" title="Index" href="../genindex.html"><link rel="search" title="Search" href="../search.html"><link rel="next" title="Using RTT" href="rtt.html"><link rel="prev" title="Semihosting" href="semihosting.html">
        <link rel="canonical" href="https://black-magic.org/usage/swo.html">
        <link rel="prefetch" href="../_static/blackmagic-logo.svg" as="image"> 

<link
  rel="alternate"
  type="application/atom+xml"
  href="../blog/atom.xml"
  title="Blog"
/>



    <!-- Generated with Sphinx 8.2.3 and Furo 2025.09.25 -->
        <title>Serial Wire Output - Black Magic Debug</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=d111a655" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=580074bf" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css?v=4c969af8" />
    <link rel="stylesheet" type="text/css" href="../_static/asciinema-player_3.12.1.css" />
    <link rel="stylesheet" type="text/css" href="../_static/ablog/tagcloud.css?v=4271035a" />
    <link rel="stylesheet" type="text/css" href="../_static/ablog/styles_for_furo.css?v=e882fc94" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=8dab3a3b" />
    
    


<style>
  body {
    --color-code-background: #f2f2f2;
  --color-code-foreground: #1e1e1e;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Black Magic Debug</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/blackmagic-logo.svg" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">Black Magic Debug</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Intro</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../hardware.html">Supported Hardware</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting-started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../upgrade.html">Firmware Upgrade</a></li>
<li class="toctree-l1"><a class="reference internal" href="../supported-targets.html">Supported Targets</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Knowledgebase</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../knowledge/faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../knowledge/terminology.html">Terminology</a></li>
<li class="toctree-l1"><a class="reference internal" href="../knowledge/pinouts.html">Pinout Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../knowledge/compiling-windows.html">Compiling on Windows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../knowledge/bmputil-on-windows.html">Building <code class="docutils literal notranslate"><span class="pre">bmputil</span></code> on Windows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../knowledge/links.html">Links</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Usage</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="gdb-commands.html">GDB Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="gdb-automation.html">GDB Flash Automation</a></li>
<li class="toctree-l1"><a class="reference internal" href="semihosting.html">Semihosting</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Serial Wire Output</a></li>
<li class="toctree-l1"><a class="reference internal" href="rtt.html">Using RTT</a></li>
<li class="toctree-l1"><a class="reference internal" href="platformio.html">PlatformIO</a></li>
<li class="toctree-l1"><a class="reference internal" href="stm32cubeide.html">STM32CubeIDE</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Target Specific Usage</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../target-usage/stm32.html">STM32 Targets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../target-usage/sam3x-4x-x7x.html">SAM3x-4x-x7x</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Hacking</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../hacking/contrib.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hacking/hacking.html">Firmware Hacking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hacking/target-drivers.html">Adding Target Drivers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hacking/target-cortex-m.html">Cortex-M Targets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hacking/target-cortex-a.html">Cortex A Targets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hacking/target-mm32.html">MindMotion MM32 Targets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hacking/target-clock-generation.html">Target Clock Generation</a></li>
</ul>

</div><h3>Versions</h3>
<ul>
	<li><a href="/">BMD 2.0 (in development)</a></li>
	<li><a href="/v1.x">BMD 1.10.2 (stable)</a></li>
</ul>
<div class="ablog-sidebar-item ablog__recentposts">
<h3>
  <a href="../blog.html">Recent Posts</a>
</h3>
<ul>
  
  
  <li>
    <a href="../blog/2025-07-19-bmd-release-v2_0_0.html">
      19 July - Black Magic Debug V2.0.0 Stable Release
    </a>
  </li>
  
  <li>
    <a href="../blog/2025-07-12-bmputil-release-v1_0_0.html">
      12 July - bmputil V1.0.0 Stable Release
    </a>
  </li>
  
  <li>
    <a href="../blog/2025-03-03-release-candidate-v2_0_0-rc2.html">
      03 March - Black Magic Debug V2.0.0-rc2 Release Candidate
    </a>
  </li>
  
  <li>
    <a href="../blog/2025-01-07-release-candidate-v2_0_0-rc1.html">
      07 January - Black Magic Debug V2.0.0-rc1 Release Candidate
    </a>
  </li>
  
  <li>
    <a href="../blog/2024-01-11-release-v1_9_3.html">
      11 January - Black Magic Debug V1.9.3 Stable Release
    </a>
  </li>
  
</ul>
</div>

<div class="ablog-sidebar-item ablog__archive">
<h3>
  <a href="../blog/archive.html">Archives</a>
</h3>
<ul>
  
  
  <li>
    <a href="../blog/2025.html">2025 (4)</a>
  </li>
  
  
  
  <li>
    <a href="../blog/2024.html">2024 (2)</a>
  </li>
  
  
  
  <li>
    <a href="../blog/2023.html">2023 (8)</a>
  </li>
  
  
  
  <li>
    <a href="../blog/2022.html">2022 (7)</a>
  </li>
  
  
</ul>
</div>
</div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="https://github.com/blackmagic-debug/black-magic-org/blob/main/usage/swo.md?plain=true" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div><div class="edit-this-page">
  <a class="muted-link" href="https://github.com/blackmagic-debug/black-magic-org/edit/main/usage/swo.md" rel="edit" title="Edit this page">
    <svg><use href="#svg-pencil"></use></svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          
          
          

          <section id="serial-wire-output">
<h1>Serial Wire Output<a class="headerlink" href="#serial-wire-output" title="Link to this heading">¶</a></h1>
<p>Serial Wire Output (SWO) allows the target to produce tracing and logging information from your firmware
without using precious peripherals such as USB or UARTs. Instead, the data is emitted via a single pin,
which is usually what would be JTAG’s TDO, but re-purposed for the purpose.</p>
<p>To set up SWO, you need to:</p>
<ul class="simple">
<li><p>Wire the target to your probe running BMD</p></li>
<li><p>Configure the target processor</p></li>
<li><p>Enable SWO handling in BMD</p></li>
<li><p>Set up a viewer for the tracing and logging data</p></li>
</ul>
<section id="wires">
<h2>Wires<a class="headerlink" href="#wires" title="Link to this heading">¶</a></h2>
<p>You will need a connection between the target’s SWO output and your probe. See your probe’s README.md for details.
As the SWO pin is typically the JTAG TDO pin, you cannot run SWO when using JTAG. Instead you will need to access
the target via SWD and perform a SWD scan before SWO will start working.</p>
<p>A setup with Blue Pills might look like this:</p>
<p><img alt="Back-to-backed Blue Pills" src="https://raw.githubusercontent.com/koendv/Connecting-Black-Magic-Probe-and-Blue-Pill/master/bmp_bp.svg" /></p>
</section>
<section id="target-processor-setup">
<h2>Target processor setup<a class="headerlink" href="#target-processor-setup" title="Link to this heading">¶</a></h2>
<p>Registers must be set up to configure the SWO pin for output. Different processors have different SWO setups.
You can setup SWO via the chosen viewer, debugger, or directly on the target.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/orbcode/orbuculum">Orbuculum</a> has scripts to configure the target in GDB, and STM32 C source to include in your build.</p></li>
<li><p><a class="reference external" href="https://github.com/compuphase/Black-Magic-Probe-Book">bmtrace</a> configures target processor in the viewer, button <em>Configure target</em>. Supports STM32 and LPC.</p></li>
<li><p><a class="reference external" href="https://github.com/koendv/SerialWireOutput">SerialWireOutput</a> arduino library, does STM32 set up in code. Userland source for initializing, <code class="docutils literal notranslate"><span class="pre">write()</span></code> and <code class="docutils literal notranslate"><span class="pre">flush()</span></code>.</p></li>
</ul>
</section>
<section id="black-magic-debug">
<h2>Black Magic Debug<a class="headerlink" href="#black-magic-debug" title="Link to this heading">¶</a></h2>
<p>When the firmware receives SWO from a target, it can do one of two things: It can send the raw capture data to the
trace interface for use by a decoder and viewer suite, or decoded ITM data to the auxillary USB serial port.</p>
<p>For everything to work, the target and probe:</p>
<ul class="simple">
<li><p>Must speak the same protocol (UART (aka Async or NRZ) or Manchester coded), and</p></li>
<li><p>For UART, at the same baud rate - this is configured as part of enabling SWO on the probe.</p></li>
</ul>
<p>There are two SWO transport protocols: Manchester coded and UART (aka async). You can see what protocol your probe
speaks with <code class="docutils literal notranslate"><span class="pre">monitor</span> <span class="pre">help</span></code>. The protocol is listed next to the <code class="docutils literal notranslate"><span class="pre">swo</span></code> command. In the case of BMP, and some
third party probes, both protocols are supported in the firmware together. In this case, the protocol to decode
is given as a part of the instruction to enable SWO.</p>
<p>The Manchester coded SWO auto-synchronizes and the firmware auto-detects baud. However, for UART SWO, you have to
configure the baud rate both in the target configuration and on the probe. The default baud rate for async is 2.25MBaud.</p>
<section id="swo-decoding-in-firmware">
<h3>SWO decoding in firmware<a class="headerlink" href="#swo-decoding-in-firmware" title="Link to this heading">¶</a></h3>
<p>You can switch on SWO decoding in BMD with</p>
<div class="highlight-gdb notranslate"><div class="highlight"><pre><span></span>monitor swo enable decode
</pre></div>
</div>
<p>This defaults to decoding all ITM streams. If your probe talks async mode, you can optionally specify a baud rate
between the <code class="docutils literal notranslate"><span class="pre">enable</span></code> verb and optionally requesting decoding. Following the <code class="docutils literal notranslate"><span class="pre">decode</span></code> verb, you can then specify
which ITM streams you wish to have decoded. For example:</p>
<div class="highlight-gdb notranslate"><div class="highlight"><pre><span></span>monitor swo enable 4500000 decode 0 2
</pre></div>
</div>
<p>This example is for an async mode probe, and configures 4.5MBaud and decoding of ITM streams 0 and 2.</p>
<p>SWO decoding in the probe does not need any special utilities and works on every OS. For setups that use only a
single ITM stream this may be all you need. Please note that if you use more than just the ITM, or if you use many
ITM channels, an external viewer such as the Orbuculum suite is required.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>On a BMP or on other platforms that implement the new switchable SWO, you will need to specify which protocol
encoding you wish to have the probe recover data from as part of the <code class="docutils literal notranslate"><span class="pre">swo</span> <span class="pre">enable</span></code> command. This is done by
specifying one of either <code class="docutils literal notranslate"><span class="pre">manchester</span></code> or <code class="docutils literal notranslate"><span class="pre">uart</span></code> just after <code class="docutils literal notranslate"><span class="pre">enable</span></code> in the invocation and if omitted defaults
to UART. Such an invocation looks like: <code class="docutils literal notranslate"><span class="pre">monitor</span> <span class="pre">swo</span> <span class="pre">enable</span> <span class="pre">manchester</span> <span class="pre">decode</span></code>.</p>
<p>As with any other command verb, you can shorten this - eg, <code class="docutils literal notranslate"><span class="pre">mon</span> <span class="pre">swo</span> <span class="pre">en</span> <span class="pre">manc</span> <span class="pre">dec</span></code> works just fine.</p>
</div>
</section>
<section id="linux">
<h3>Linux<a class="headerlink" href="#linux" title="Link to this heading">¶</a></h3>
<p>Please first ensure that you have set up udev with the appropriate set of
<a class="reference external" href="https://github.com/blackmagic-debug/blackmagic/tree/main/driver">the project’s udev rules</a> so you get the proper
device permissions, and the friendly serial interface names in /dev.</p>
<p>To view the decoded data stream you can then connect in to <code class="docutils literal notranslate"><span class="pre">/dev/ttyBmpTarg</span></code> (or include your probe’s serial number
after if you have more than one plugged in) using your favourite serial terminal program such as <code class="docutils literal notranslate"><span class="pre">screen</span></code>, <code class="docutils literal notranslate"><span class="pre">minicom</span></code>
or, in a pinch, <code class="docutils literal notranslate"><span class="pre">cat</span></code>.</p>
<p>If the decoded ITM stream data is not shown, check the configured baud rate on the target or on the probe.</p>
</section>
<section id="windows">
<h3>Windows<a class="headerlink" href="#windows" title="Link to this heading">¶</a></h3>
<p>The probe shows up in Device Manager as two COM ports and two other USB interfaces. For Windows 8, 10 and 11, no
drivers should needto be installed to use the device and all interfaces should show up properly out of the box.
For earlier versions of Windows, you will need to use the
<a class="reference external" href="https://github.com/blackmagic-debug/blackmagic/tree/main/driver">two driver installation <code class="docutils literal notranslate"><span class="pre">.inf</span></code> files</a> to get
Windows to bind the proper drivers to the device interfaces.</p>
<p>Once your probe has all interfaces properly bound, connect a program such as
<a class="reference external" href="https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html">PuTTY</a> or any other serial terminal program to
the “Black Magic UART Port” COM port. On W8+ you will need to locate the COM port with the higher interface number
in Device Manager. This may not be the higher numbered COM port.</p>
</section>
</section>
<section id="external-viewer">
<h2>External viewer<a class="headerlink" href="#external-viewer" title="Link to this heading">¶</a></h2>
<p>You can switch on SWO for external viewers with</p>
<div class="highlight-gdb notranslate"><div class="highlight"><pre><span></span>monitor swo enable
</pre></div>
</div>
<p>The recovered SWO data is output to the USB trace interface. If using a probe that works with async mode, you can
specify a baud rate like so: <code class="docutils literal notranslate"><span class="pre">monitor</span> <span class="pre">swo</span> <span class="pre">enable</span> <span class="pre">1125000</span></code>. The default is 2.25MBaud.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>On a BMP or on other platforms that implement the new switchable SWO, you will need to specify which protocol
encoding you wish to have the probe recover data from as part of the <code class="docutils literal notranslate"><span class="pre">swo</span> <span class="pre">enable</span></code> command. This is done by
specifying one of either <code class="docutils literal notranslate"><span class="pre">manchester</span></code> or <code class="docutils literal notranslate"><span class="pre">uart</span></code> just after <code class="docutils literal notranslate"><span class="pre">enable</span></code> in the invocation and if omitted defaults
to UART. Such an invocation looks like: <code class="docutils literal notranslate"><span class="pre">monitor</span> <span class="pre">swo</span> <span class="pre">enable</span> <span class="pre">manchester</span></code>.</p>
<p>As with any other command verb, you can shorten this - eg, <code class="docutils literal notranslate"><span class="pre">mon</span> <span class="pre">swo</span> <span class="pre">en</span> <span class="pre">manc</span></code> works just fine.</p>
</div>
<section id="viewers">
<h3>Viewers<a class="headerlink" href="#viewers" title="Link to this heading">¶</a></h3>
<p>The following is a (non-comprehensive) list of viewers that can work with Black Magic Debug Firmware:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/orbcode/orbuculum">Orbuculum</a> - A comprehensive but easy to use suite of tools with GDB
scripts for target setup. Run <code class="docutils literal notranslate"><span class="pre">orbuculum</span></code> to start collecting trace data. (All OSes. Command line driven)</p></li>
<li><p><a class="reference external" href="https://github.com/blackmagic-debug/blackmagic/blob/main/scripts/swolisten.c">swolisten</a> - Simplistic in-tree viewer
for ITM data and predecessor to Orbuculum. (Linux-only. Command line driven)</p></li>
<li><p><a class="reference external" href="https://github.com/compuphase/Black-Magic-Probe-Book">bmtrace</a> - Basic ITM stream viewer. Configures BMD and tries
to configure your target for you. Windows binaries available. (Windows and Linux only. Graphical)</p></li>
</ul>
</section>
</section>
<section id="halting-swo-recovery">
<h2>Halting SWO recovery<a class="headerlink" href="#halting-swo-recovery" title="Link to this heading">¶</a></h2>
<p>If you wish to stop recovery of SWO, decoding of ITM data, or need to get the firmware to resynchronise with your
target, you can run <code class="docutils literal notranslate"><span class="pre">monitor</span> <span class="pre">swo</span> <span class="pre">disable</span></code> to spin the SWO engine down. Note, this frees any buffers associated
with the SWO data recovery and resets state. This is required if you wish to scan for targets over JTAG.</p>
</section>
<section id="what-even-is-swo-and-what-is-it-used-for-really">
<h2>What even is SWO and what is it used for really?<a class="headerlink" href="#what-even-is-swo-and-what-is-it-used-for-really" title="Link to this heading">¶</a></h2>
<p>SWO, or Serial Wire Output, is one of two methods available in ARM’s CoreSight tracing and instrumentation framework
for getting data out of a target over a sideband channel to the main debugging channel or mechanisms like a UART or RTT.
The two output methods are Trace and SWO.</p>
<p>Trace is a parallel mechanism that has a 1, 2, or 4 bit (most commonly, though more bits are possible in higher spec
parts) wide bus + clock for rappidly outputting tracing, requiring specialised connectors like ARM’s 20-pin CoreSight
connector, or a Mictor connector. This is great for very high bandwidth but requires specific design considerations and
adaptors like ORBTrace, or one of the big commercial offerings like Lauterbach’s TRACE32 tools. This is expensive.</p>
<p>SWO however uses just a single pin (sometimes known as TRACESWO, though strictly just SWO) which repurposes what would be
the JTAG TDO pin. It cannot achieve particularly high throughput by comparison, but it is very simple to use and is
provided on a stadard ARM 10-pin CoreSight connector. Do note though that not all parts supply trace outputs, so do
check the part’s datasheet to ensure it can do this. An example is the RP2040 which forgoes the tracing infrastructure
entirely.</p>
<section id="okay-but-what-can-swo-actually-do">
<h3>Okay, but what can SWO actually do?<a class="headerlink" href="#okay-but-what-can-swo-actually-do" title="Link to this heading">¶</a></h3>
<p>The way that CoreSight is architected means there are a few moving pieces to this question. We will work from the output
pin itself backwards as this should hopefully make it make the most sense.</p>
<p>The first piece and the part which makes wiggles on a pin or set of pins, is the TPIU (Trace Port Interface Unit). This
is the component which receives tracing and instrumentation data from the ATB (Advanced Trace Bus) and turns all that
into a coherent stream on the wire. This includes choosing whether the data will be output over Trace or SWO interfaces,
and if over SWO whether that will be via Manchester or UART (Async) encoding schemes. It contains a FIFO for the data
being produced.</p>
<p>Feeding a TPIU are trace funnels, which multiplex multiple tracing/instrumentation sources into a single coherent
ATB stream for the TPIU. We can mostly ignore this though and focus on what feeds a trace funnel with data.</p>
<p>Data sources include the ETM (Embedded Trace Macrocell) and ITM (Instrumentation Trace Macrocell). These are what the
following sections focus on and discuss. Note, if you enable more than one source you <em>must</em> enable TPIU framing for
formatting. This is so the recievier can then figure out which component a given packet came from to decode and consume.</p>
</section>
<section id="the-etm">
<h3>The ETM<a class="headerlink" href="#the-etm" title="Link to this heading">¶</a></h3>
<p>This is a component that is not found on all Cortex-M parts, but is found on many. The main job of this component is to
trace execution on its attached core - sampling the program counter, and allowing building of an execution flow graph.
Depending on the version of the ETM integrated onto the target core, this can take the form of either samples every
few instructions (eg, once every 16th cycle), or it can be a complete trace of execution w/ the ETM halting execution
when the FIFO gets too full.</p>
<p>This component is integral to the Cortex-M core and is found duplicated on all cores that the integrating vendor has
chosen to enable execution tracing on. There are 3 main versions you will encounter in the wild: v3, v3.5 and v4.
Older versions of the ETM are found on older core designs typically, though the vendor may choose to replace, eg,
a Cortex-M3’s defualt ETM with a newer ETMv4 as part of integrating debug and trace in a system that uses newer tracing
components downstream of the ETM.</p>
</section>
<section id="the-itm">
<h3>The ITM<a class="headerlink" href="#the-itm" title="Link to this heading">¶</a></h3>
<p>This is a component usually found on all Cortex-M cores, with some notable exceptions. The main job of this component is
to allow you to instrument your firmware with state that allows fine grained tunable tracing of flow with the one downside
that it is intrusive, unlike the ETM. There are up to 32 “stimulus ports” provided by the block which the processor
can write into to output state information - for example, port 0 used for the main execution thread, while port 1 is
used for interrupt tracing w/ 8-bit writes done to each to output simple ASCII characters, or 32-bit writes to output
addresses in the code being executed.</p>
<p>The data output to the ITM from the code is free-form. Each core has its own instance of the ITM w/ differing capabilities
depending on what the vendor integrates. The packets output by the ITM onto the ATB are called SWIT packets - SoftWare
Instrumentation Trace packets.</p>
<p>The ITM depends on one additional block in the core for generating timestamping and other utility functions - the DWT.
In typical usage, the DWT must be configured to enable synchronisation for timing. This is also the source of triggers
for the ETM for when it will sample the program counter.</p>
</section>
<section id="putting-it-all-together">
<h3>Putting it all together<a class="headerlink" href="#putting-it-all-together" title="Link to this heading">¶</a></h3>
<p>An example is provided below showing how you can configure Manchester-mode SWO on a STM32 atop of libopencm3:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#define SWO_BAUDRATE 115200U</span>
<span class="cp">#define ARM_LAR_ACCESS_ENABLE 0xc5acce55U</span>

<span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">swo_setup</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">	</span><span class="cm">/* Enable tracing in DEMCR */</span>
<span class="w">	</span><span class="n">SCS_DEMCR</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="n">SCS_DEMCR_TRCENA</span><span class="p">;</span>

<span class="w">	</span><span class="cm">/* Get the active clock frequency of the core and use that to calculate a divisor */</span>
<span class="w">	</span><span class="k">const</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">clock_frequency</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rcc_ahb_frequency</span><span class="p">;</span>
<span class="w">	</span><span class="k">const</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">divisor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">clock_frequency</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">SWO_BAUDRATE</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1U</span><span class="p">;</span>
<span class="w">	</span><span class="cm">/* And configure the TPIU for 1-bit async trace (SWO) in Manchester coding */</span>
<span class="w">	</span><span class="n">TPIU_LAR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ARM_LAR_ACCESS_ENABLE</span><span class="p">;</span>
<span class="w">	</span><span class="n">TPIU_CSPSR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1U</span><span class="p">;</span><span class="w"> </span><span class="cm">/* 1-bit mode */</span>
<span class="w">	</span><span class="n">TPIU_ACPR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">divisor</span><span class="p">;</span>
<span class="w">	</span><span class="n">TPIU_SPPR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TPIU_SPPR_ASYNC_MANCHESTER</span><span class="p">;</span>
<span class="w">	</span><span class="cm">/* Ensure that TPIU framing is off */</span>
<span class="w">	</span><span class="n">TPIU_FFCR</span><span class="w"> </span><span class="o">&amp;=</span><span class="w"> </span><span class="o">~</span><span class="n">TPIU_FFCR_ENFCONT</span><span class="p">;</span>

<span class="w">	</span><span class="cm">/* Configure the DWT to provide the sync source for the ITM */</span>
<span class="w">	</span><span class="n">DWT_LAR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ARM_LAR_ACCESS_ENABLE</span><span class="p">;</span>
<span class="w">	</span><span class="n">DWT_CTRL</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="mh">0x000003feU</span><span class="p">;</span>
<span class="w">	</span><span class="cm">/* Enable access to the ITM registers and configure tracing output from the first stimulus port */</span>
<span class="w">	</span><span class="n">ITM_LAR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ARM_LAR_ACCESS_ENABLE</span><span class="p">;</span>
<span class="w">	</span><span class="cm">/* User-level access to the first 8 ports */</span>
<span class="w">	</span><span class="n">ITM_TPR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x0000000fU</span><span class="p">;</span>
<span class="w">	</span><span class="n">ITM_TCR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ITM_TCR_ITMENA</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">ITM_TCR_SYNCENA</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">ITM_TCR_TXENA</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">ITM_TCR_SWOENA</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">(</span><span class="mi">1U</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">16U</span><span class="p">);</span>
<span class="w">	</span><span class="n">ITM_TER</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1U</span><span class="p">;</span>

<span class="w">	</span><span class="cm">/* Now tell the DBGMCU that we want trace enabled and mapped as SWO */</span>
<span class="w">	</span><span class="n">DBGMCU_CR</span><span class="w"> </span><span class="o">&amp;=</span><span class="w"> </span><span class="o">~</span><span class="n">DBGMCU_CR_TRACE_MODE_MASK</span><span class="p">;</span>
<span class="w">	</span><span class="n">DBGMCU_CR</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="n">DBGMCU_CR_TRACE_IOEN</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">DBGMCU_CR_TRACE_MODE_ASYNC</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
</section>

           
          <div class="section ablog__blog_comments">
            
            
          </div>
          
          
        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="rtt.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Using RTT</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="semihosting.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Semihosting</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022-2023, Piotr Esden-Tempski &lt;piotr@esden.net&gt;; 2022-2023, Rachel Mant &lt;git@dragonmux.network&gt;
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Serial Wire Output</a><ul>
<li><a class="reference internal" href="#wires">Wires</a></li>
<li><a class="reference internal" href="#target-processor-setup">Target processor setup</a></li>
<li><a class="reference internal" href="#black-magic-debug">Black Magic Debug</a><ul>
<li><a class="reference internal" href="#swo-decoding-in-firmware">SWO decoding in firmware</a></li>
<li><a class="reference internal" href="#linux">Linux</a></li>
<li><a class="reference internal" href="#windows">Windows</a></li>
</ul>
</li>
<li><a class="reference internal" href="#external-viewer">External viewer</a><ul>
<li><a class="reference internal" href="#viewers">Viewers</a></li>
</ul>
</li>
<li><a class="reference internal" href="#halting-swo-recovery">Halting SWO recovery</a></li>
<li><a class="reference internal" href="#what-even-is-swo-and-what-is-it-used-for-really">What even is SWO and what is it used for really?</a><ul>
<li><a class="reference internal" href="#okay-but-what-can-swo-actually-do">Okay, but what can SWO actually do?</a></li>
<li><a class="reference internal" href="#the-etm">The ETM</a></li>
<li><a class="reference internal" href="#the-itm">The ITM</a></li>
<li><a class="reference internal" href="#putting-it-all-together">Putting it all together</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=7f41d439"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=46bd48cc"></script>
    <script src="../_static/tabs.js?v=3ee01567"></script>
    <script src="../_static/asciinema-player_3.12.1.js"></script>
    </body>
</html>