<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" type="image/svg+xml" href="../../_static/favicon/icon.svg">
    <link rel="icon" sizes="16x16" type="image/png" href="../../_static/favicon/favicon-16x16.png">
    <link rel="icon" sizes="32x32" type="image/png" href="../../_static/favicon/favicon-32x32.png">
    <link rel="apple-touch-icon" sizes="57x57" type="image/png" href="../../_static/favicon/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" type="image/png" href="../../_static/favicon/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" type="image/png" href="../../_static/favicon/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" type="image/png" href="../../_static/favicon/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="96x96" type="image/png" href="../../_static/favicon/apple-touch-icon-96x96.png">
    <link rel="apple-touch-icon" sizes="114x114" type="image/png" href="../../_static/favicon/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" type="image/png" href="../../_static/favicon/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" type="image/png" href="../../_static/favicon/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" type="image/png" href="../../_static/favicon/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" type="image/png" href="../../_static/favicon/apple-touch-icon-180x180.png">
    <link rel="android-icon" sizes="192x192" type="image/png" href="../../_static/favicon/android-icon-192x192.png"><meta property="og:title" content="Serial Wire Output" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://black-magic.org/v1.x/usage/swo.html" />
<meta property="og:site_name" content="Black Magic Debug" />
<meta property="og:description" content="Serial Wire Output (SWO) allows the target to produce tracing and logging information from your firmware without using precious peripherals such as USB or UARTs. Instead, the data is emitted via a ..." />
<meta property="og:image" content="https://black-magic.org/_static/blackmagic-logo.png" />
<meta property="og:image:alt" content="Black Magic Debug" />
<meta name="description" content="Serial Wire Output (SWO) allows the target to produce tracing and logging information from your firmware without using precious peripherals such as USB or UARTs. Instead, the data is emitted via a ..." />

    <title>Serial Wire Output &#8212; Black Magic Debug  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=27fed22d" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../../_static/asciinema-player_3.6.3.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/platformpicker.css" />
    <script src="../../_static/documentation_options.js?v=7f41d439"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/asciinema-player_3.6.3.js"></script>
    <script src="../../_static/platformpicker.js"></script>
    <link rel="canonical" href="https://black-magic.org/v1.x/usage/swo.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  

  
  
 
<link
  rel="alternate"
  type="application/atom+xml"
  href="../../blog/atom.xml"
  title="Blog"
/>
  
  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
             <section id="serial-wire-output">
<h1>Serial Wire Output<a class="headerlink" href="#serial-wire-output" title="Link to this heading">¶</a></h1>
<p>Serial Wire Output (SWO) allows the target to produce tracing and logging information from your firmware
without using precious peripherals such as USB or UARTs. Instead, the data is emitted via a single pin,
which is usually what would be JTAG’s TDO, but re-purposed for the purpose.</p>
<p>To set up SWO, you need to:</p>
<ul class="simple">
<li><p>Wire the target to your probe running BMD</p></li>
<li><p>Configure the target processor</p></li>
<li><p>Enable SWO handling in BMD</p></li>
<li><p>Set up a viewer for the tracing and logging data</p></li>
</ul>
<section id="wires">
<h2>Wires<a class="headerlink" href="#wires" title="Link to this heading">¶</a></h2>
<p>You will need a connection between the target’s SWO output and your probe. See your probe’s README.md for details.
As the SWO pin is typically the JTAG TDO pin, you cannot run SWO when using JTAG. Instead you will need to access
the target via SWD and perform a SWD scan before SWO will start working.</p>
<p>A setup with Blue Pills might look like this:</p>
<p><img alt="Back-to-backed Blue Pills" src="https://raw.githubusercontent.com/koendv/Connecting-Black-Magic-Probe-and-Blue-Pill/master/bmp_bp.svg" /></p>
</section>
<section id="target-processor-setup">
<h2>Target processor setup<a class="headerlink" href="#target-processor-setup" title="Link to this heading">¶</a></h2>
<p>Registers must be set up to configure the SWO pin for output. Different processors have different SWO setups.
You can setup SWO via the chosen viewer, debugger, or directly on the target.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/orbcode/orbuculum">Orbuculum</a> has scripts to configure the target in GDB, and STM32 C source to include in your build.</p></li>
<li><p><a class="reference external" href="https://github.com/compuphase/Black-Magic-Probe-Book">bmtrace</a> configures target processor in the viewer, button <em>Configure target</em>. Supports STM32 and LPC.</p></li>
<li><p><a class="reference external" href="https://github.com/koendv/SerialWireOutput">SerialWireOutput</a> arduino library, does STM32 set up in code. Userland source for initializing, <code class="docutils literal notranslate"><span class="pre">write()</span></code> and <code class="docutils literal notranslate"><span class="pre">flush()</span></code>.</p></li>
</ul>
</section>
<section id="black-magic-debug">
<h2>Black Magic Debug<a class="headerlink" href="#black-magic-debug" title="Link to this heading">¶</a></h2>
<p>When the firmware receives SWO from a target, it can do one of two things: It can send the raw capture data to the
trace interface for use by a decoder and viewer suite, or decoded ITM data to the auxillary USB serial port.</p>
<p>For everything to work, the target and probe:</p>
<ul class="simple">
<li><p>Must speak the same protocol (UART (aka Async or NRZ) or Manchester coded), and</p></li>
<li><p>For UART, at the same baud rate - this is configured as part of enabling SWO on the probe.</p></li>
</ul>
<p>There are two SWO transport protocols: Manchester coded and UART (aka async). You can see what protocol your probe
speaks with <code class="docutils literal notranslate"><span class="pre">monitor</span> <span class="pre">help</span></code>. The protocol is listed next to the <code class="docutils literal notranslate"><span class="pre">traceswo</span></code> command.</p>
<p>The Manchester coded SWO auto-synchronizes and the firmware auto-detects baud. However, for UART SWO, you have to
configure the baud rate both in the target configuration and on the probe. The default baud rate for async is 2.25MBaud.</p>
<section id="swo-decoding-in-firmware">
<h3>SWO decoding in firmware<a class="headerlink" href="#swo-decoding-in-firmware" title="Link to this heading">¶</a></h3>
<p>You can switch on SWO decoding in BMD with</p>
<div class="highlight-gdb notranslate"><div class="highlight"><pre><span></span>monitor traceswo decode
</pre></div>
</div>
<p>This defaults to decoding all ITM streams. If your probe talks async mode, you can optionally specify a baud rate
before optionally requesting decoding. Following the <code class="docutils literal notranslate"><span class="pre">decode</span></code> verb, you can then specify which ITM streams you
wish to have decoded. For example:</p>
<div class="highlight-gdb notranslate"><div class="highlight"><pre><span></span>monitor traceswo 4500000 decode 0 2
</pre></div>
</div>
<p>This example is for an async mode probe, and configures 4.5MBaud and decoding of ITM streams 0 and 2.</p>
<p>SWO decoding in the probe does not need any special utilities and works on every OS. For setups that use only a
single ITM stream this may be all you need. Please note that if you use more than just the ITM, or if you use many
ITM channels, an external viewer such as the Orbuculum suite is required.</p>
</section>
<section id="linux">
<h3>Linux<a class="headerlink" href="#linux" title="Link to this heading">¶</a></h3>
<p>Please first ensure that you have set up udev with the appropriate set of
<a class="reference external" href="https://github.com/blackmagic-debug/blackmagic/tree/main/driver">the project’s udev rules</a> so you get the proper
device permissions, and the friendly serial interface names in /dev.</p>
<p>To view the decoded data stream you can then connect in to <code class="docutils literal notranslate"><span class="pre">/dev/ttyBmpTarg</span></code> (or include your probe’s serial number
after if you have more than one plugged in) using your favourite serial terminal program such as <code class="docutils literal notranslate"><span class="pre">screen</span></code>, <code class="docutils literal notranslate"><span class="pre">minicom</span></code>
or, in a pinch, <code class="docutils literal notranslate"><span class="pre">cat</span></code>.</p>
<p>If the decoded ITM stream data is not shown, check the configured baud rate on the target or on the probe.</p>
</section>
<section id="windows">
<h3>Windows<a class="headerlink" href="#windows" title="Link to this heading">¶</a></h3>
<p>The probe shows up in Device Manager as two COM ports and two other USB interfaces. For Windows 8, 10 and 11, no
drivers should needto be installed to use the device and all interfaces should show up properly out of the box.
For earlier versions of Windows, you will need to use the
<a class="reference external" href="https://github.com/blackmagic-debug/blackmagic/tree/main/driver">two driver installation <code class="docutils literal notranslate"><span class="pre">.inf</span></code> files</a> to get
Windows to bind the proper drivers to the device interfaces.</p>
<p>Once your probe has all interfaces properly bound, connect a program such as
<a class="reference external" href="https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html">PuTTY</a> or any other serial terminal program to
the “Black Magic UART Port” COM port. On W8+ you will need to locate the COM port with the higher interface number
in Device Manager. This may not be the higher numbered COM port.</p>
</section>
</section>
<section id="external-viewer">
<h2>External viewer<a class="headerlink" href="#external-viewer" title="Link to this heading">¶</a></h2>
<p>You can switch on SWO for external viewers with</p>
<div class="highlight-gdb notranslate"><div class="highlight"><pre><span></span>monitor traceswo
</pre></div>
</div>
<p>The recovered SWO data is output to the USB trace interface. If using a probe that works with async mode, you can
specify a baud rate like so: <code class="docutils literal notranslate"><span class="pre">monitor</span> <span class="pre">traceswo</span> <span class="pre">1125000</span></code>. The default is 2.25MBaud.</p>
<section id="viewers">
<h3>Viewers<a class="headerlink" href="#viewers" title="Link to this heading">¶</a></h3>
<p>The following is a (non-comprehensive) list of viewers that can work with Black Magic Debug Firmware:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/orbcode/orbuculum">Orbuculum</a> - A comprehensive but easy to use suite of tools with GDB
scripts for target setup. Run <code class="docutils literal notranslate"><span class="pre">orbuculum</span></code> to start collecting trace data. (All OSes. Command line driven)</p></li>
<li><p><a class="reference external" href="https://github.com/blackmagic-debug/blackmagic/blob/main/scripts/swolisten.c">swolisten</a> - Simplistic in-tree viewer
for ITM data and predecessor to Orbuculum. (Linux-only. Command line driven)</p></li>
<li><p><a class="reference external" href="https://github.com/compuphase/Black-Magic-Probe-Book">bmtrace</a> - Basic ITM stream viewer. Configures BMD and tries
to configure your target for you. Windows binaries available. (Windows and Linux only. Graphical)</p></li>
</ul>
</section>
</section>
<section id="halting-swo-recovery">
<h2>Halting SWO recovery<a class="headerlink" href="#halting-swo-recovery" title="Link to this heading">¶</a></h2>
<p>In this series of the firmware, there is no way to stop SWO recovery once enabled. If you wish to reset state,
say to use JTAG, you must reboot your probe. This has been addressed in the v2.x series.</p>
</section>
<section id="bmp-v2-3-hardware-not-able-to-capture-swo">
<h2>BMP v2.3 hardware not able to capture SWO<a class="headerlink" href="#bmp-v2-3-hardware-not-able-to-capture-swo" title="Link to this heading">¶</a></h2>
<p>It is a known bug in the v1.x series firmware that SWO recovery on GD32F103-based BMPs does not function.
This is due to a complex interaction between the Manchester stream recovery logic and the timer peripheral
used to implement this function. This bug has been addressed in the v2.x series. Please prefer that instead.</p>
</section>
</section>

<div class="section ablog__blog_comments">
   
</div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../index.html">
    <img class="logo" src="../../_static/blackmagic-logo.svg" alt="Logo" />
    
  </a>
</p>



<p class="blurb">The Plug&Play MCU Debugger</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=blackmagic-debug&repo=blackmagic&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Intro</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../hardware.html">Supported Hardware</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting-started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../upgrade.html">Firmware Upgrade</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../supported-targets.html">Supported Targets</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Knowledgebase</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../knowledge/faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../knowledge/terminology.html">Terminology</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../knowledge/pinouts.html">Pinout Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../knowledge/compiling-windows.html">Compiling on Windows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../knowledge/bmputil-on-windows.html">Building <code class="docutils literal notranslate"><span class="pre">bmputil</span></code> on Windows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../knowledge/links.html">Links</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Usage</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../usage/gdb-commands.html">GDB Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage/gdb-automation.html">GDB Flash Automation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage/semihosting.html">Semihosting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage/swo.html">Serial Wire Output</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage/rtt.html">Using RTT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage/platformio.html">PlatformIO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage/stm32cubeide.html">STM32CubeIDE</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Target Specific Usage</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../target-usage/stm32.html">STM32 Targets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../target-usage/sam3x-4x-x7x.html">SAM3x-4x-x7x</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Hacking</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../hacking/contrib.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hacking/hacking.html">Firmware Hacking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hacking/target-drivers.html">Adding Target Drivers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hacking/target-cortex-m.html">Cortex-M Targets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hacking/target-cortex-a.html">Cortex A Targets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hacking/target-mm32.html">MindMotion MM32 Targets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hacking/target-clock-generation.html">Target Clock Generation</a></li>
</ul>

<h3>Versions</h3>
<ul>
	<li><a href="/">BMD 2.0 (in development)</a></li>
	<li><a href="/v1.x">BMD 1.10.2 (stable)</a></li>
</ul>
<div class="ablog-sidebar-item ablog__recentposts">
  <h3>
    <a href="../../blog.html">Recent Posts</a>
  </h3>
  <ul>
     
    <li>
      <a href="../../blog/2025-07-19-bmd-release-v2_0_0.html">
        19 July - Release Candidate V2.0.0
      </a>
    </li>
    
    <li>
      <a href="../../blog/2025-03-03-release-candidate-v2_0_0-rc2.html">
        03 March - Release Candidate V2.0.0-rc2
      </a>
    </li>
    
    <li>
      <a href="../../blog/2025-01-07-release-candidate-v2_0_0-rc1.html">
        07 January - Release Candidate V2.0.0-rc1
      </a>
    </li>
    
    <li>
      <a href="../../blog/2024-01-11-release-v1_9_3.html">
        11 January - Stable Release V1.9.3
      </a>
    </li>
    
    <li>
      <a href="../../blog/2024-01-10-release-v1_10_2.html">
        10 January - Stable Release V1.10.2
      </a>
    </li>
    
  </ul>
</div>

<div class="ablog-sidebar-item ablog__archives">
  <h3>
    <a href="../../blog/archive.html">Archives</a>
  </h3>
  <ul>
     
    <li>
      <a href="../../blog/2025.html">2025 (3)</a>
    </li>
      
    <li>
      <a href="../../blog/2024.html">2024 (2)</a>
    </li>
      
    <li>
      <a href="../../blog/2023.html">2023 (8)</a>
    </li>
      
    <li>
      <a href="../../blog/2022.html">2022 (7)</a>
    </li>
     
  </ul>
</div>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2022-2023, Piotr Esden-Tempski <piotr@esden.net>; 2022-2023, Rachel Mant <git@dragonmux.network>.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
    </div>

    

    
  </body>
</html>